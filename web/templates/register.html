{% extends "base.html" %}

{% block title %}Register Student | Smart Attendance{% endblock %}

{% block content %}
<section class="container" id="registerRoot" data-total-images="{{ images_per_student }}">
    <div class="page-head">
        <h1>Student Registration</h1>
        <p>Capture high-quality face samples for the recognition system.</p>
    </div>

    <div class="split-layout">
        <section class="card">
            <div class="card-head">
                <h2>Registration Form</h2>
            </div>
            <div class="card-body">
                <form id="registerForm" class="form-grid">
                    <label class="field">
                        <span>Full Name</span>
                        <input id="nameInput" name="name" type="text" class="input" placeholder="Enter student's full name" required>
                    </label>
                    <label class="field">
                        <span>Roll Number / Student ID</span>
                        <input id="rollInput" name="roll_number" type="text" class="input" placeholder="Example: 2301105473 or ROLL-2301-105-473" required>
                        <small style="color: #6f8388; font-size: 0.85em; margin-top: 4px; display: block;">Auto-formatting supports spaces, dashes, and common prefixes.</small>
                    </label>

                    <div class="camera-panel">
                        <video id="videoPreview" autoplay playsinline muted></video>
                        <canvas id="captureCanvas" hidden></canvas>
                        <div class="camera-badge" id="captureCount">0 / {{ images_per_student }}</div>
                    </div>

                    <div class="toolbar">
                        <button type="button" id="startCameraBtn" class="btn btn-primary">Start Camera</button>
                        <button type="button" id="stopCameraBtn" class="btn btn-secondary" disabled>Stop Camera</button>
                        <button type="button" id="autoCaptureBtn" class="btn btn-secondary" disabled>Auto Capture</button>
                        <button type="button" id="clearCaptureBtn" class="btn btn-ghost">Clear</button>
                    </div>

                    <div id="capturedGrid" class="capture-grid"></div>

                    <div class="toolbar">
                        <button type="submit" id="submitBtn" class="btn btn-primary" disabled>Register Student</button>
                    </div>
                </form>
            </div>
        </section>

        <aside class="card">
            <div class="card-head">
                <h2>Capture Guidelines</h2>
            </div>
            <div class="card-body">
                <ul class="hint-list">
                    <li>Keep camera at eye level.</li>
                    <li>Capture slight pose variations (front, left, right).</li>
                    <li>Use stable and even lighting.</li>
                    <li>Keep one face in the frame.</li>
                    <li>Wait for auto-capture to complete before submitting.</li>
                    <li>Use a neutral expression.</li>
                    <li>Avoid glasses glare or face coverings.</li>
                </ul>
            </div>
        </aside>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/register.js') }}"></script>
{% endblock %}
